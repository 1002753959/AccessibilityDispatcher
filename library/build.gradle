apply plugin: 'com.android.library'

ext {
	releaseNoteFile = 'ChangeLog.md'            // 相对路径，填仓库下该文件地址即可
	libraryName = 'AccessibilityDispatcher'     // bintray项目名字以及aar的名字，确定好了就不要在修改了
	libLabels = ['android', 'accessibility']    // bintray项目的标签

	//compile 'publishedGroupId:artifact:libraryVersionName'

	publishedGroupId = 'io.github.zhitaocai'    // 项目组ID(e.g 包名为io.github.zhitaocai.toastcompat, 那么这里就是io.github.zhitaocai)
	artifact = 'accessibilitydispatcher'        // 项目ID  (e.g 包名为io.github.zhitaocai.toastcompat, 那么这里就是toastcompat)
	libraryVersionName = '0.4.0'                // 对应的versionname
	libraryVersionCode = 4

	libDesc = 'an library for using accessibility service more convenient'  // 项目描述
	libraryVersionDesc = libDesc                                            // 当前版本下的项目描述
	repoTag = libraryVersionName                                            // 当前版本下所对应的仓库的tag
	gitRepo = 'zhitaocai/AccessibilityDispatcher'                           // 仓库短地址
	siteUrl = 'https://github.com/zhitaocai/AccessibilityDispatcher'
	gitUrl = 'https://github.com/zhitaocai/AccessibilityDispatcher.git'
	issueUrl = 'https://github.com/zhitaocai/AccessibilityDispatcher/issues'

	isPackageResources = true                   // 是否打包资源文件进去，是的话，就需要打包R.class
}

android {
	compileSdkVersion 25
	buildToolsVersion "25.0.1"

	defaultConfig {
		minSdkVersion 14
		targetSdkVersion 25
		versionCode libraryVersionCode
		versionName libraryVersionName

		consumerProguardFiles 'proguard-rules.pro'

		//testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
	}
	buildTypes {
		release {
			minifyEnabled false
			proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
		}
	}

	compileOptions {
		encoding "UTF-8"
		sourceCompatibility JavaVersion.VERSION_1_7
		targetCompatibility JavaVersion.VERSION_1_7
	}

	libraryVariants.all { variant ->
		// 修改aar的名字和输出路径
		variant.outputs.each { output ->
			def outputFile = output.outputFile
			if (outputFile != null && outputFile.name.endsWith('.aar')) {
				def fileName = "${artifact}-${variant.buildType.name}-${libraryVersionName}.aar"
				// output.outputFile = new File(outputFile.parent, fileName)
				output.outputFile = new File(project.rootProject.getProjectDir().getAbsolutePath() + "/aar/" + fileName)
			}
		}
//		if (variant.name == 'release') {
//			task("generate${variant.name.capitalize()}Javadoc", type: Javadoc) {
//				// title = ''
//				// description = ''
//				source = variant.javaCompile.source
//				classpath = files(variant.javaCompile.classpath.files, project.android.getBootClasspath())
//				options {
//					encoding "UTF-8"
//					links "http://docs.oracle.com/javase/7/docs/api/"
//					linksOffline "http://d.android.com/reference", "${android.sdkDirectory}/docs/reference"
//					failOnError false
//				}
//				exclude '**/BuildConfig.java'
//				exclude '**/R.java'
//			}
//			task("javadoc${variant.name.capitalize()}Jar", type: Jar, dependsOn: "generate${variant.name.capitalize()}Javadoc") {
//				classifier = 'javadoc'
//				from tasks.getByName("generate${variant.name.capitalize()}Javadoc").destinationDir
//			}
//
//			task androidReleaseJar(type: Jar, dependsOn: assembleRelease) {
//				from "$buildDir/intermediates/classes/release/"
//				exclude '**/BuildConfig.class'
//				exclude '**/R.class'
//				exclude '**/R$*.class'
//				classifier 'sources11'
//				baseName project.ext.artifact
//			}
//
//			artifacts {
//				archives tasks.getByName("androidReleaseJar")
//				//archives tasks.getByName("javadoc${variant.name.capitalize()}Jar")
//			}
//		}
	}
}

//configurations {
//	javadocDeps
//}

dependencies {
	//	compile fileTree(dir: 'libs', include: ['*.jar'])
	//	androidTestCompile('com.android.support.test.espresso:espresso-core:2.2.2', {
	//		exclude group: 'com.android.support', module: 'support-annotations'
	//	})
	//	compile 'com.android.support:appcompat-v7:25.3.0'
	//	testCompile 'junit:junit:4.12'
	// compile 'com.android.support:support-annotations:25.3.0'

	compile 'com.android.support:support-annotations:25.3.0'

	//avadocDeps 'com.android.support:support-annotations:25.3.0'
}

apply from: 'publish.gradle'

